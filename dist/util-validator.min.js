/*! UtilValidate v1.0.0 | https://unpkg.com/utilvalidate@1.0.0/LICENSE.txt */
var UtilValidateExports={};!function(e){function t(e){var t=e.which?e.which:event.keyCode;return!(t>31&&(t<48||t>57)&&(t<96||t>105&&110!=t))}function n(e){var t=e.which?e.which:event.keyCode;return!(150==t||t>31&&(t<48||t>57))}function a(e,t){return t?(e=e.replace(/[^0-9]/g,""),e=e.replace(/(\d{3})(\d{3})(\d{3})/,"($1) $2-$3")):e.replace(/[^0-9]/g,"")}function r(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function i(e){return moment(e).isValid()}function o(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function l(e){this.value=e,this.setEngineBaseValue=function(e){this.value=e},this.handleRequired=function(){var e=this;return!(!e.value||null==e.value||""==e.value||(e.value+"").trim().length<=0)},this.handleNumeric=function(e){var t=this;if(!t.value)return!0;var n=+t.value;return e&&_.isNumber(+e)?_.isNumber(n)&&!_.isNaN(n)&&n>=+e:_.isNumber(n)&&!_.isNaN(n)},this.handleEmail=function(){var e=this;return o(e.value)},this.handlePhonenumber=function(){var e=this,t=e.value||"";t=(t+"").replace(/[^0-9]/g,"");var n=+t;return t.trim().length>=9&&_.isNumber(n)&&!_.isNaN(n)},this.handleDate=function(e){return moment(this.value,e).isValid()},this.handleDateRange=function(e,t,n){var a=this,r=!0,i=!0;if(_.isArray(t)&&!_.isUndefined(t)){var o,l=moment(a.value||"",e);_.each(t,function(t,n){t?(o=moment(t,e),l.isBefore(o)&&(r=r&&!1)):r=r&&!0})}if(_.isArray(n)&&!_.isUndefined(n)){var o,l=moment(a.value||"",e);_.each(n,function(t,n){t?(o=moment(t,e),l.isAfter(o)&&(i=i&&!1)):i=i&&!0})}return{min:r,max:i}},this.handlePair=function(e,t){var n=this;return t?n.value.toUpperCase()==e.toUpperCase():n.value==e},this.handleRegExp=function(e){var t=this;return e.test(t.value)}}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")};var u=angular.module("util-flexitech.validate",[]);u.service("utilValidate",["$filter",function(e){var u={makeid:r,isNumberKey:t,isPhoneKey:n,isDate:i,formatPhonenumber:a,isEmail:o};return u.engine=new l,u.getEngine=function(e){return new l(e)},u}]),u.directive("utilValidate",["utilValidate","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",controller:["$scope","$location","$rootScope","$timeout",function(e,t,n,a){_.isUndefined(n.predefinedListOfControl)&&(n.predefinedListOfControl=[]),n.resetControls=function(e){e?n.predefinedListOfControl=[]:_.each(n.predefinedListOfControl,function(e,t){e.dirty=!1,e.reset()})},n.resetControlsByGroup=function(e){_.each(n.predefinedListOfControl,function(t,n){_.isUndefined(e)?(t.dirty=!1,t.reset()):t.groups.indexOf(e)>-1&&(t.dirty=!1,t.reset())})},e.setDirty=function(e,t){_.each(n.predefinedListOfControl,function(n,a){n.id==e&&(n.dirty=t)})},n.setDirtyAll=function(e,t){_.each(n.predefinedListOfControl,function(e,n){e.dirty=t})},n.removeControl=function(e){n.predefinedListOfControl=_.filter(n.predefinedListOfControl,function(t){return t.id!=e})},n.validate=function(e){var t=!1,a=!1;return _.each(n.predefinedListOfControl,function(n,r){if(_.isUndefined(e)){var i=n.manualValidate();t=t||i.length>0}else if(n.groups.indexOf(e)>-1){var i=n.manualValidate();t=t||i.length>0}t&&!a&&n.allowFocus&&(a=n.focus())}),t},n.disableGroup=function(e,t){n.$broadcast("onDisableGroups",{groups:e,value:t})},e.root=n}],link:function(n,a,r,i){function o(){if(!m.enableValidate)return[];m.engine.setEngineBaseValue(i.$viewValue);var e=[];return _.each(m["default"].types,function(t,n){var a,r=!0;switch(t){case"required":r=r&&m.engine.handleRequired();break;case"numeric":r=r&&m.engine.handleNumeric(m["default"]["min-number"]);break;case"email":r=r&&m.engine.handleEmail();break;case"phone-number":r=r&&m.engine.handlePhonenumber();break;case"date":r=r&&m.engine.handleDate(m["default"]["date-format"]);break;case"pair":r=r&&m.engine.handlePair($("#"+m["default"]["pair-id"]).val());break;case"pair-date":"start"==m["default"]["pair-type"].toLowerCase()?(a=m.engine.handleDateRange(m["default"]["date-format"],[m["default"]["min-value"]],[m["default"]["max-value"],angular.element("#"+m["default"]["pair-id"]).val()]),r=r&&1==a.min&&1==a.max):"end"==m["default"]["pair-type"].toLowerCase()?(a=m.engine.handleDateRange(m["default"]["date-format"],[m["default"]["min-value"],angular.element("#"+m["default"]["pair-id"]).val()],[m["default"]["max-value"]]),r=r&&1==a.min&&1==a.max):r=r&&!1;break;case"reg-exp":r=r&&m.engine.handleRegExp(m["default"]["reg-exp"]);break;default:r=r&&!0}r||e.push({type:t,dirty:!0,extras:a})}),m.timeout&&t.cancel(m.timeout),e.length>0&&(m.timeout=t(function(){d(e)},m.TIMEOUT_BEFORE_EXECUTE)),e}function l(){"INPUT"!=c&&"TEXTAREA"!=c&&"SELECT"!=c||a.attr("placeholder",m.defaultPlaceholderText),!_.isUndefined(m["default"]["custom-error-class"])&&m["default"]["custom-error-class"].trim().length>0&&(m["default"].select2===!0?a.parent().removeClass(m["default"]["custom-error-class"]):m["default"].selectize===!0?a.parent().children(".selectize-control").children(".selectize-input").removeClass(m["default"]["custom-error-class"]):a.removeClass(m["default"]["custom-error-class"])),n.setDirty(m.controlID,!1),m.hasError=!1}function u(e){i.$setViewValue(e),i.$viewValue=e,i.$render(),m.engine.setEngineBaseValue(i.$viewValue)}function d(e){m&&(u(m["default"]["default-value"]||null),!_.isUndefined(m["default"]["custom-error-message"])&&m["default"]["custom-error-message"].trim().length>0&&a.attr("placeholder",m["default"]["custom-error-message"]),!_.isUndefined(m["default"]["custom-error-class"])&&m["default"]["custom-error-class"].trim().length>0&&(m["default"].select2===!0?a.parent().addClass(m["default"]["custom-error-class"]):m["default"].selectize===!0?a.parent().children(".selectize-control").children(".selectize-input").addClass(m["default"]["custom-error-class"]):a.addClass(m["default"]["custom-error-class"])),!_.isUndefined(m["default"]["broadcast-event"])&&m["default"]["broadcast-event"].length>0&&n.root.$broadcast(m["default"]["broadcast-event"],{controlID:a.attr("id")||m.controlID,falsy:!0,extras:e}),n.setDirty(m.controlID,!0),m.hasError=!0)}function s(){n.root.predefinedListOfControl.push({id:m.controlID,index:1*m["default"].index||n.root.predefinedListOfControl.length+1,friendlyId:a.attr("id"),modelName:r.ngModel,dirty:!1,groups:m["default"]["group-names"],allowFocus:void 0!==m["default"]["allow-focus"]||1*m["default"]["allow-focus"],reset:function(){l()},disableValidate:function(){n.root.$broadcast("onEnableValidate",m.controlID)},enableValidate:function(){n.root.$broadcast("onDisableValidate",m.controlID)},manualValidate:function(){return o()},focus:function(){if(1*m["default"]["allow-focus"]){var e=1*m["default"]["focus-top-offset"]||40,t=null;if(t=m["default"].select2===!0||m["default"].selectize===!0?a.parent():a,m["default"]["modal-scroll"]){var n=t.position().top-e;n=n<0?0:n,$("#"+m["default"]["modal-scroll"]).animate({scrollTop:n},400)}else{var n=t.offset().top-e;n=n<0?0:n,$("html, body").animate({scrollTop:n},400)}return t=null,!0}return!1}}),"DIV"==c&&(!r.watcher,m.event.change=function(){return!m.enableValidate||void m.engine.setEngineBaseValue(i.$viewValue)})}function f(){_.isUndefined(m["default"].realtime)&&"false"==m["default"].realtime||(m.event.keypress=function(t){if(!m.enableValidate)return!0;if(m["default"].types.indexOf("phone-number")>-1){var n=e.isPhoneKey(t.originalEvent);if(n){var r=(new Date).getTime();return r-h<m.TIMEOUT_BEFORE_USER_RELEASE?(m.temp.promiseKeypress=setTimeout(function(){u(e.formatPhonenumber(a.val(),!0))},m.TIMEOUT_BEFORE_EXECUTE),void(h=r)):(h=r,u(e.formatPhonenumber(a.val(),!0)),!0)}return!1}return m["default"].types.indexOf("numeric")>-1?e.isNumberKey(t.originalEvent)||190==t.keyCode||t.keyCode>=37&&t.keyCode<=40:void 0},m.event.focus=function(){l(),n.$broadcast("onMirror",{model:r.ngModel,id:m.controlID}),m.enableValidate&&m["default"].types.indexOf("phone-number")>-1&&u(e.formatPhonenumber(a.val(),!1))},m.event.change=function(){l(),n.$broadcast("onMirror",{model:r.ngModel,id:m.controlID}),m.enableValidate&&m["default"].types.indexOf("phone-number")>-1&&u(e.formatPhonenumber(a.val(),!1))},m.event.blur=function(t){m.enableValidate&&m["default"].types.indexOf("phone-number")>-1&&u(e.formatPhonenumber(a.val(),!0))},a.on("keydown",function(e){return m.event.keypress(e)}),a.on("focus",function(e){m.event.focus(e)}),a.on("blur",function(e){m.event.blur(e)}),a.on("change",function(e){m.event.change(e)}))}if(setTimeout(function(){var e="string";n.$broadcast("validatorReady",e),n.$apply()},500),i){var c=a.prop("tagName").toUpperCase(),m={};m.elem=a,m.tagName=c,m.defaultPlaceholderText="INPUT"==c||"TEXTAREA"==c||"SELECT"==c?a.attr("placeholder"):a.text(),m.controlID=e.makeid(5)+""+(new Date).getTime(),(!a.attr("id")||a.attr("id").trim().length<=0)&&a.attr("id",m.controlID),m.TIMEOUT_BEFORE_USER_RELEASE=1e3,m.TIMEOUT_BEFORE_EXECUTE=300,m.temp={},m.engine=e.getEngine(i.$viewValue),m.event={},m.event.focus=function(){l()},m.enableValidate=!0,m.hasError=!1;var h=(new Date).getTime(),v=r.$observe("validatorToggleEnabled",function(e,t){null!=e&&void 0!=e&&(e="true"===e,m.enableValidate=e)}),p=n.$on("onEnableValidate",function(e,t){m.controlID!=t&&a.attr("id")!=t||(m.enableValidate=!0)}),g=n.$on("onDisableValidate",function(e,t){m.controlID!=t&&a.attr("id")!=t||(m.enableValidate=!1)}),b=n.$on("onManualValidate",function(e,t){m.enableValidate&&(m.controlID!=t&&a.attr("id")!=t||o())}),E=(n.$on("onMirror",function(t,n){n.model==r.ngModel&&n.id!=m.controlID&&(l(),m["default"].types.indexOf("phone-number")>-1&&u(e.formatPhonenumber(a.val(),!0)))}),n.$on("onDisableGroups",function(e,t){var n=!1;m["default"]["group-names"].length<=0?n=!1:_.each(m["default"]["group-names"],function(e,a){n=n||t.groups.indexOf(e)>-1}),n&&(m.enableValidate=t.value)})),y=i.$render;i.$render=function(){y&&y(),"div"==c.toLowerCase()},r.$observe("watcher",function(e){"DIV"==c&&(m["default"]&&l(),i.$setViewValue(e),i.$render(),m["default"]&&m["default"].on&&m["default"].on.indexOf("change")>-1&&m.event.change&&m.event.change())}),n.$on("validatorReady",function(e,t){if(null!=m&&!m.init){m.init=!0;var n=r.validatorconfig||r.config;m["default"]=angular.fromJson(n),_.isUndefined(m["default"].disable)||(m.enableValidate=!m["default"].disable),s(),f(),m["default"].on&&_.each(m["default"].on,function(e){"custom"!=e&&a.on(e,function(t){return!m.enableValidate||(o(),m.event[e]?m.event[e](t):void 0)})})}}),n.$on("$destroy",function(){b(),p(),v(),g(),E(),n.root.removeControl(m.controlID),m=null,delete m})}}}}]),u.version="1.0.0",e.UtilValidate=u}(UtilValidateExports),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t:"function"==typeof define&&define.amd?define(t):e.UtilValidate=t}(this,UtilValidateExports.UtilValidate);